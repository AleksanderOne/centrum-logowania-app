#!/bin/sh
# Pre-push hook: uruchamia lint, testy z coverage, e2e i build przed wypchniÄ™ciem na remote

echo "ğŸ” Sprawdzam kod linterem (ESLint)..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ BÅ‚Ä™dy lintera! Push zablokowany."
  echo "ğŸ’¡ Uruchom 'npm run lint:fix' aby naprawiÄ‡ automatyczne bÅ‚Ä™dy."
  exit 1
fi

echo "ğŸ“Š Sprawdzam pokrycie kodu testami (wymagane 100%)..."
npm run test:coverage
if [ $? -ne 0 ]; then
  echo "âŒ Coverage poniÅ¼ej 100%! Push zablokowany."
  echo "ğŸ“‹ Wymagane: 100% statements, branches, functions, lines"
  echo "ğŸ’¡ Uruchom 'npm run test:coverage' aby zobaczyÄ‡ szczegÃ³Å‚y."
  exit 1
fi

echo "ğŸ”¨ Sprawdzam czy projekt siÄ™ buduje..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ BÅ‚Ä…d budowania aplikacji! Push zablokowany."
  exit 1
fi

echo "ğŸ­ Uruchamiam testy e2e..."
npm run test:e2e
if [ $? -ne 0 ]; then
  echo "âŒ Testy E2E nie powiodÅ‚y siÄ™! Push zablokowany."
  exit 1
fi

echo "âœ… Pre-push checks zakoÅ„czone pomyÅ›lnie! Wypychanie dozwolone."
