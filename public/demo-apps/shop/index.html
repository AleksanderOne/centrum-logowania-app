<!doctype html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Demo Shop - Zintegrowane</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = { darkMode: 'class' };
    </script>
    <!-- WspÃ³lna konfiguracja demo -->
    <script src="../demo-config.js"></script>
    <script src="../setup-wizard.js"></script>
    <!-- SDK Centrum Logowania -->
    <script src="../../sdk/auth.js"></script>
  </head>

  <body
    class="bg-gray-100 dark:bg-gray-900 flex flex-col items-center justify-center min-h-screen transition-colors duration-300 font-sans"
  >
    <!-- Theme Toggle -->
    <div class="absolute top-4 right-4">
      <button
        id="theme-toggle"
        class="p-2 rounded-full bg-gray-200 dark:bg-slate-700 text-gray-800 dark:text-yellow-300 hover:shadow-lg transition"
      >
        <span class="dark:hidden">â˜€ï¸</span><span class="hidden dark:inline">ğŸŒ™</span>
      </button>
    </div>

    <!-- GÅ‚Ã³wny Kontener Aplikacji (DomyÅ›lnie ukryty, SDK go pokaÅ¼e jak bÄ™dzie autoryzacja) -->
    <div
      id="shop-app"
      class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-xl w-full max-w-md text-center hidden"
    >
      <div class="mb-4 text-4xl">ğŸ›’</div>
      <h1 class="text-2xl font-bold mb-2 text-gray-900 dark:text-white">Super Sklep</h1>

      <div
        class="bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 p-4 rounded text-left my-6"
      >
        <p class="text-sm text-green-800 dark:text-green-300 font-bold mb-1">âœ… Witaj w sklepie!</p>
        <div id="user-display" class="text-xs text-gray-600 dark:text-gray-300 font-mono"></div>
      </div>

      <button
        data-auth-logout
        class="w-full border border-red-200 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 py-2 rounded transition"
      >
        Wyloguj ze sklepu
      </button>
    </div>

    <!-- Inicjalizacja z uÅ¼yciem wspÃ³lnej konfiguracji -->
    <script>
      CentrumLogowania.protect({
        clientId: window.DEMO_CONFIG.clientId,
        authUrl: window.DEMO_CONFIG.authUrl, // undefined = auto-wykrywany
        appId: 'shop-app',
        onLogin: (user) => {
          document.getElementById('user-display').innerHTML = `
                    <p>ID: ${user.id}</p>
                    <p>Email: ${user.email}</p>
                `;
        },
      });

      // ObsÅ‚uga motywu
      const btn = document.getElementById('theme-toggle');
      const html = document.documentElement;
      if (
        localStorage.theme === 'dark' ||
        (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      )
        html.classList.add('dark');
      btn.onclick = () => {
        html.classList.toggle('dark');
        localStorage.theme = html.classList.contains('dark') ? 'dark' : 'light';
      };
    </script>
  </body>
</html>
